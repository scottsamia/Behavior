function show(n){$("pre").text(JSON.stringify(n,null,2))}function extend(n){var t=Array.prototype.slice.call(arguments,1);return t.forEach(function(t){if(t&&typeof t=="object")for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])}),n}var behavior=behavior||{};behavior.firebase=function(){var n,t,i=function(i){$.ajax({url:"/Firebase/getFirebaseConfig",type:"GET",context:this,success:function(r){t=r;firebase.initializeApp(t);this.database=firebase.database();this.students=firebase.database().ref("students");this.behaviors=firebase.database().ref("behaviors");n=!0;i(n)},error:function(){n=!1;i(n)}})},r=function(t){var t=t||{},r,i,u;if(n&&!$.isEmptyObject(t)){r=this.database.ref().child("students").push().key;i={};i["/students/"+r]=t;for(u in t.behaviors)i["/behaviors/"+u+"/students/"+r]=!0;return this.database.ref().update(i),!0}return!1},u=function(t){var t=t||{};return n&&!$.isEmptyObject(t)?(this.database.ref("students/"+t.id).update(t.attributes),!0):!1},f=function(){},e=function(t){var t=t||{},r,i;return n&&!$.isEmptyObject(t)?(r=this.database.ref().child("countSessions").push().key,i={},i["/countSessions/"+r]=t,i["/students/"+t.studentID+"/countSessions/"+r]=!0,this.database.ref().update(i),t):{}},o=function(n){this.students.once("value").then(function(t){n(t.val())})},s=function(n){this.behaviors.once("value").then(function(t){n(t.val())})},h=function(n,t){this.students.child(n.id).child("countSessions").once("value").then(function(n){t(n.val())})};return{config:t,init:i,database:null,addStudent:r,updateStudent:u,deleteStudent:f,getListOfStudents:o,getListOfBehaviors:s,addCountSession:e,getCountSessions:h}}();$("#addStudent").on("click",function(){for(var t={firstName:$("#FirstName").val(),lastName:$("#LastName").val(),age:$("#Age").val(),behaviors:{}},i=$("select#Behaviors").val(),n=0;n<i.length;n++)t.behaviors[i[n]]=!0;behavior.firebase.addStudent(t)&&($("#FirstName").val(""),$("#LastName").val(""),$("#Age").val(0),$("select#Behaviors").val([]))});$("#updateStudent").on("click",function(){var n={id:$("input#id").val(),attributes:{firstName:$("input#FirstName").val(),lastName:$("input#LastName").val(),age:$("input#Age").val()}};behavior.firebase.updateStudent(n)});behavior=behavior||{};behavior.counter=function(){var t=function(t,i){this.count=0;this.startTime=new Date;console.log("The start time is: "+this.startTime);this.database=t;this.student=i;this.behavior=null;n(this.count)},i=function(){this.count++;n(this.count)},r=function(){this.count>0&&this.count--;n(this.count)},u=function(){this.endTime=new Date;var n=Math.round((this.endTime.getTime()-this.startTime.getTime())/1e3);return{studentID:this.student.id,startTime:this.startTime,endTime:this.endTime,behavior:this.behavior,duration:n,count:behavior.counter.count}},n=function(n){$(".counterLbl").text(n);$(".counterStartTime").text(this.startTime)};return{count:null,init:t,increase:i,decrease:r,getCountSession:u}}();$("select#Behaviors").on("change",function(){var n=$("select#Behaviors").val();behavior.counter.behavior=$(this).val()});$("#countUp").on("click",function(){behavior.counter.increase()});$("#countDown").on("click",function(){behavior.counter.decrease()});$("#save").on("click",function(){if(behavior.counter.behavior=$("#behaviorID").val(),behavior.counter.behavior!=null){var n=behavior.firebase.addCountSession(behavior.counter.getCountSession());$.isEmptyObject(n)||($("#SessionDuration").text(n.duration+" seconds"),$("#resultsSection").removeClass("hidden"),$("#countUp").hide(),$("#countDown").hide(),$("#save").hide())}});$("#back").on("click",function(){window.location.href="/Home/Index"});$("#newSession").on("click",function(){window.location.reload()});behavior=behavior||{};behavior.student=function(){var t=function(n,t){this.database=n;this.id=t},i=function(t){typeof this.id!="undefined"&&this.database.ref("/students/"+this.id).once("value").then(function(i){var r=i.val();n(r);t(r)})},n=function(n){this.firstName=n.firstName;this.lastName=n.lastName;this.age=n.age};return{init:t,getStudent:i,setStudent:n}}();